<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TiriSolar ‚Äî Landing con Chatbot</title>
  <style>
    :root{
      --bg: #f0fdf4; /* emerald-50 */
      --brand: #059669; /* emerald-600 */
      --brand-dark:#047857; /* emerald-700 */
      --ink:#0f172a; /* slate-900 */
      --muted:#475569; /* slate-600 */
      --card:#ffffff;
      --border:#e2e8f0; /* slate-200 */
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;color:var(--ink);background:linear-gradient(to bottom,var(--bg),#fff)}
    a{color:inherit;text-decoration:none}
    .container{max-width:1120px;margin:0 auto;padding:0 24px}
    header{position:sticky;top:0;background:rgba(255,255,255,.92);backdrop-filter:blur(8px);border-bottom:1px solid var(--border);z-index:40}
    .nav{display:flex;align-items:center;justify-content:space-between;padding:16px 0}
    .brand{display:flex;gap:8px;align-items:center}
    .brand-badge{width:36px;height:36px;border-radius:12px;background:var(--brand);color:#fff;display:grid;place-items:center;font-weight:700}
    .btn{display:inline-block;border-radius:12px;padding:10px 16px;font-size:14px}
    .btn-primary{background:var(--brand);color:#fff}
    .btn-primary:hover{background:var(--brand-dark)}
    .btn-ghost{border:1px solid #a7f3d0;color:#065f46}
    .btn-ghost:hover{background:#ecfdf5}
    .hero{padding:64px 0}
    .grid{display:grid;gap:24px}
    @media(min-width:900px){.grid-2{grid-template-columns:1fr 1fr}}
    .hero-card{aspect-ratio:16/9;border:1px solid var(--border);border-radius:16px;background:linear-gradient(135deg,#a7f3d0,#f0fdf4);box-shadow:inset 0 0 30px rgba(0,0,0,.05);display:grid;place-items:center;position:relative;overflow:hidden}
    h1{margin:0;font-size:40px;line-height:1.1}
    .muted{color:var(--muted)}
    section{padding:48px 0}
    .cards{display:grid;gap:16px}
    @media(min-width:900px){.cards-3{grid-template-columns:repeat(3,1fr)}}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;box-shadow:0 4px 10px rgba(2,6,23,.04)}
    .card .body{padding:24px}
    .price{font-size:28px;font-weight:700}
    footer{border-top:1px solid var(--border)}
    
    .sim-btn{position:absolute;top:10px;right:10px;background:rgba(255,255,255,.95);border:1px solid #a7f3d0;border-radius:10px;padding:6px 10px;font-size:12px;color:#065f46;cursor:pointer}

    /* Chatbot */
    #chat-launch{position:fixed;right:20px;bottom:20px;width:56px;height:56px;border-radius:999px;background:var(--brand);color:#fff;border:none;display:grid;place-items:center;box-shadow:0 10px 20px rgba(4,120,87,.35);cursor:pointer;z-index:50}
    #chat-panel{position:fixed;right:20px;bottom:90px;width:360px;max-width:calc(100vw - 40px);max-height:70vh;background:rgba(255,255,255,.97);backdrop-filter:blur(8px);border:1px solid #a7f3d0;border-radius:16px;box-shadow:0 12px 30px rgba(4,120,87,.25);display:none;flex-direction:column;overflow:hidden;z-index:50}
    #chat-head{display:flex;align-items:center;justify-content:space-between;background:var(--brand);color:#fff;padding:10px 14px}
    #chat-quick{display:flex;gap:8px;flex-wrap:wrap;padding:10px;border-bottom:1px solid #d1fae5}
    #chat-quick button{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #a7f3d0;background:#fff;color:#065f46;cursor:pointer}
    #chat-log{padding:12px 12px 60px;overflow:auto;flex:1}
    .msg{display:flex;gap:8px;margin-bottom:8px}
    .msg .bubble{padding:8px 10px;border-radius:14px;max-width:75%;font-size:14px}
    .bot .bubble{background:#ecfdf5;color:#064e3b}
    .user{justify-content:flex-end}
    .user .bubble{background:var(--brand);color:#fff}
    #chat-input{position:absolute;left:0;right:0;bottom:0;padding:8px;background:#fff;border-top:1px solid #e2e8f0;display:flex;gap:8px}
    #chat-input input{flex:1;padding:10px 12px;border:1px solid #cbd5e1;border-radius:10px}
    #chat-input button{padding:10px 14px;border:none;border-radius:10px;background:var(--brand);color:#fff;cursor:pointer}
    /* Modal simple */
    .modal-backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.45);z-index:60}
    .modal{width:min(520px,92vw);border-radius:16px;background:#fff;border:1px solid #e2e8f0;box-shadow:0 20px 60px rgba(2,6,23,.25)}
    .modal .hd{padding:14px 16px;border-bottom:1px solid #e2e8f0;font-weight:600}
    .modal .bd{padding:16px}
    .modal .ft{padding:12px 16px;border-top:1px solid #e2e8f0;display:flex;gap:8px;justify-content:flex-end}
    .form-row{display:grid;grid-template-columns:120px 1fr;gap:10px;align-items:center;margin-bottom:10px}
    .form-row input[type="text"],.form-row input[type="email"],.form-row input[type="tel"]{border:1px solid #cbd5e1;border-radius:10px;padding:10px}
    .tag{display:inline-block;padding:4px 8px;border-radius:10px;background:#ecfeff;color:#0e7490;font-size:12px;border:1px solid #a5f3fc}
  
  
  
  </style>
</head>
<body>
  <header>
    <div class="container nav">
      <div class="brand">
        <div class="brand-badge">Ti</div>
        <strong>TiriSolar</strong>
      </div>
      <nav class="hide-sm">
        <a href="#planes" style="margin-right:16px">Planes</a>
        <a href="#beneficios" style="margin-right:16px">Beneficios</a>
        <a href="#faq">FAQ</a>
      </nav>
      <a class="btn btn-primary" href="#planes">Desde $1,000</a>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="container grid grid-2">
        <div>
          <h1>Energ√≠a solar, simple y accesible.</h1>
          <p class="muted" style="margin-top:10px;font-size:18px">Empieza desde $1,000 (USD). Instalaci√≥n profesional y soporte de 5 a√±os.</p>
          <div style="margin-top:18px;display:flex;gap:12px;flex-wrap:wrap">
            <a class="btn btn-primary" href="#planes">Ver planes</a>
            <a class="btn btn-ghost" href="#faq">C√≥mo funciona</a>
          </div>
          <div class="muted" style="margin-top:10px;font-size:12px">Moneda: USD ‚Ä¢ Soporte 5 a√±os ‚Ä¢ Frontend</div>
        </div>
        <div>
          <div class="hero-card">
            <button class="sim-btn" id="sim-rerun" title="Volver a simular">Re‚Äësimular</button>
            <svg id="sim-chart" viewBox="0 0 800 450" preserveAspectRatio="none" width="100%" height="100%">
              <defs>
                <linearGradient id="simFill" x1="0" y1="0" x2="0" y2="1">
                  <stop offset="0%" stop-color="#059669" stop-opacity="0.35" />
                  <stop offset="100%" stop-color="#059669" stop-opacity="0.05" />
                </linearGradient>
              </defs>
              <!-- Frame -->
              <rect x="0" y="0" width="800" height="450" fill="transparent" />
              <!-- Axes -->
              <line x1="60" y1="20" x2="60" y2="414" stroke="#94a3b8" stroke-width="1" />
              <line x1="60" y1="414" x2="784" y2="414" stroke="#94a3b8" stroke-width="1" />
              <!-- Ticks -->
              <g id="sim-yticks"></g>
              <g id="sim-xticks"></g>
              <!-- Data area & line -->
              <path id="sim-area" fill="url(#simFill)"></path>
              <path id="sim-line" fill="none" stroke="#065f46" stroke-width="3" stroke-linejoin="round" stroke-linecap="round"></path>
              <!-- Labels -->
              <text x="18" y="28" fill="#065f46" font-size="12" transform="rotate(-90,18,28)">Potencia (kW)</text>
              <text x="720" y="440" fill="#334155" font-size="12">Hora</text>
              <text x="80" y="40" fill="#065f46" font-size="14" font-weight="600">Simulaci√≥n diaria ‚Äî producci√≥n FV</text>
            </svg>
          </div>
        </div>
      </div>
    </section>

    <section id="beneficios">
      <div class="container cards cards-3">
        <div class="card"><div class="body">
          <div style="font-weight:600">Ahorro</div>
          <p class="muted" style="margin-top:6px;font-size:14px">Reduce tu factura el√©ctrica con generaci√≥n propia.</p>
        </div></div>
        <div class="card"><div class="body">
          <div style="font-weight:600">Calidad</div>
          <p class="muted" style="margin-top:6px;font-size:14px">Componentes de marcas reconocidas y montaje profesional.</p>
        </div></div>
        <div class="card"><div class="body">
          <div style="font-weight:600">Soporte 5 a√±os</div>
          <p class="muted" style="margin-top:6px;font-size:14px">Acompa√±amiento t√©cnico y mantenimiento preventivo b√°sico.</p>
        </div></div>
      </div>
    </section>

    <section id="planes">
      <div class="container">
        <h2 style="margin:0 0 6px 0">Planes</h2>
        <p class="muted" style="margin:0 0 16px 0">Precios en USD. Soporte incluido por 5 a√±os.</p>
        <div class="cards cards-3">
          <div class="card">
            <div class="body" style="border-bottom:1px solid var(--border)">
              <div style="color:#047857;font-weight:600;font-size:14px">Ideal para residencias peque√±as</div>
              <div style="margin-top:4px;font-size:18px;font-weight:600">Starter 1.5 kW</div>
              <div class="price" style="margin-top:10px">$1,000 <span class="muted" style="font-size:14px;font-weight:400">desde</span></div>
            </div>
            <div class="body" style="padding-top:16px">
              <ul style="margin:0 0 16px 18px;font-size:14px;color:#334155;line-height:1.6">
                <li>Hasta 4 paneles</li>
                <li>Monitoreo b√°sico</li>
                <li>Soporte 5 a√±os</li>
                <li>Instalaci√≥n est√°ndar</li>
              </ul>
              <a class="btn btn-primary" style="width:100%;text-align:center" href="#contacto">Solicitar cotizaci√≥n</a>
            </div>
          </div>

          <div class="card">
            <div class="body" style="border-bottom:1px solid var(--border)">
              <div style="color:#047857;font-weight:600;font-size:14px">Hogar familiar o peque√±o negocio</div>
              <div style="margin-top:4px;font-size:18px;font-weight:600">Pro 3‚Äì5 kW</div>
              <div class="price" style="margin-top:10px">$3,500 <span class="muted" style="font-size:14px;font-weight:400">desde</span></div>
            </div>
            <div class="body" style="padding-top:16px">
              <ul style="margin:0 0 16px 18px;font-size:14px;color:#334155;line-height:1.6">
                <li>6‚Äì12 paneles</li>
                <li>App de monitoreo</li>
                <li>Optimizaci√≥n de consumo</li>
                <li>Soporte 5 a√±os</li>
              </ul>
              <a class="btn btn-primary" style="width:100%;text-align:center" href="#contacto">Solicitar cotizaci√≥n</a>
            </div>
          </div>

          <div class="card">
            <div class="body" style="border-bottom:1px solid var(--border)">
              <div style="color:#047857;font-weight:600;font-size:14px">Comercial/industrial ligero</div>
              <div style="margin-top:4px;font-size:18px;font-weight:600">Business 10+ kW</div>
              <div class="price" style="margin-top:10px">$12,000 <span class="muted" style="font-size:14px;font-weight:400">desde</span></div>
            </div>
            <div class="body" style="padding-top:16px">
              <ul style="margin:0 0 16px 18px;font-size:14px;color:#334155;line-height:1.6">
                <li>Dise√±o a medida</li>
                <li>Telemetr√≠a avanzada</li>
                <li>Prioridad de soporte</li>
                <li>Soporte 5 a√±os</li>
              </ul>
              <a class="btn btn-primary" style="width:100%;text-align:center" href="#contacto">Solicitar cotizaci√≥n</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section id="faq">
      <div class="container cards">
        <div class="card"><div class="body"><div style="font-weight:600">¬øQu√© incluye el plan?</div><p class="muted" style="margin-top:6px;font-size:14px">Dise√±o, instalaci√≥n est√°ndar, configuraci√≥n de inversor/monitor, puesta en marcha y soporte por 5 a√±os.</p></div></div>
        <div class="card"><div class="body"><div style="font-weight:600">¬øCu√°nto tarda?</div><p class="muted" style="margin-top:6px;font-size:14px">Desde aprobaci√≥n y visita t√©cnica: 3‚Äì7 d√≠as h√°biles. Instalaci√≥n t√≠pica: 1‚Äì2 d√≠as.</p></div></div>
        <div class="card"><div class="body"><div style="font-weight:600">¬øLa moneda?</div><p class="muted" style="margin-top:6px;font-size:14px">USD. Todos los precios se expresan en d√≥lares estadounidenses.</p></div></div>
        <div class="card"><div class="body"><div style="font-weight:600">¬øNecesito bater√≠as?</div><p class="muted" style="margin-top:6px;font-size:14px">Son opcionales. Esta demo no incluye almacenamiento; podemos cotizarlo aparte.</p></div></div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container row">
      <div>¬© <span id="year"></span> TiriSolar ‚Ä¢ Demo frontend</div>
      <div style="display:flex;gap:16px">
        <a href="#planes">Planes</a>
        <a href="#faq">FAQ</a>
        <a href="#">Privacidad</a>
      </div>
    </div>
  </footer>

  <!-- Chatbot -->
  <button id="chat-launch" aria-label="Abrir chat" title="Chatear">
    <!-- icon -->
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M7 8h10v2H7V8zm0 4h7v2H7v-2zm5 8a1 1 0 0 1-.707-.293L8.586 17H5a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h14a3 3 0 0 1 3 3v8a3 3 0 0 1-3 3h-6l-3.293 3.293A1 1 0 0 1 12 20z"/></svg>
  </button>

  <div id="chat-panel">
    <div id="chat-head">
      <strong>TiriBot</strong>
      <button id="chat-close" title="Cerrar" style="background:transparent;border:none;color:#fff;font-size:20px;cursor:pointer">√ó</button>
    </div>
    <div id="chat-quick"></div>
    <div id="chat-log"></div>
    <div id="chat-input">
      <input id="chat-text" placeholder="Escribe aqu√≠..." />
      <button id="chat-send">Enviar</button>
    </div>
  </div>

  <script>
    // Footer year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Chatbot logic
    const launch = document.getElementById('chat-launch');
    const panel  = document.getElementById('chat-panel');
    const closeB = document.getElementById('chat-close');
    const log    = document.getElementById('chat-log');
    const input  = document.getElementById('chat-text');
    const send   = document.getElementById('chat-send');
    const quick  = document.getElementById('chat-quick');

    const quickBtns = [
      { label: 'Cotizar', payload: 'cotizar' },
      { label: '¬øQu√© incluye?', payload: 'incluye' },
      { label: 'Plazos', payload: 'plazos' },
      { label: 'Contacto', payload: 'contacto' }
    ];

    function addMsg(role, text){
      const row = document.createElement('div');
      row.className = 'msg ' + (role === 'bot' ? 'bot' : 'user');
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.textContent = text;
      row.appendChild(bubble);
      log.appendChild(row);
      log.scrollTop = log.scrollHeight;
    }

    function reply(userText){
      const lower = userText.toLowerCase();
      const responses = [];
      if(/(cotiza|coti|precio|plan)/.test(lower)){
        responses.push('Perfecto. Para estimar: 1) consumo mensual en kWh, 2) tipo de techo, 3) ciudad. El plan inicia en $1000 (USD). ¬øResidencial, comercial o industrial?');
      }
      if(/(incluye|qu√© incluye|incluye\?|que incluye)/.test(lower)){
        responses.push('Todos los planes incluyen: dise√±o, instalaci√≥n est√°ndar, configuraci√≥n del inversor/monitor, puesta en marcha y soporte por 5 a√±os.');
      }
      if(/(plazo|tiempo|instala)/.test(lower)){
        responses.push('Tiempos t√≠picos: 3‚Äì7 d√≠as h√°biles desde aprobaci√≥n y site survey. La instalaci√≥n toma 1‚Äì2 d√≠as para residencias.');
      }
      if(/(contacto|whatsapp|email|correo|tel)/.test(lower)){
        responses.push('D√©jame un nombre y un n√∫mero o correo, y te contactamos. (Frontend demo: no se env√≠a nada).');
      }
      if(responses.length===0){
        responses.push('Puedo ayudarte a cotizar o explicar los planes. Prueba con: ‚Äúcotizar‚Äù, ‚Äúqu√© incluye‚Äù, ‚Äúplazos‚Äù o ‚Äúcontacto‚Äù.');
      }
      addMsg('user', userText);
      responses.forEach(t=>addMsg('bot', t));
    }

    // Initialize quick buttons and welcome
    quickBtns.forEach(q=>{
      const b=document.createElement('button');
      b.textContent=q.label; b.onclick=()=>reply(q.payload);
      quick.appendChild(b);
    });
    addMsg('bot','Hola, soy TiriBot ü§ñ. ¬øTe ayudo a cotizar, conocer planes o tiempos?');

    // Events
    launch.onclick=()=>{ panel.style.display = panel.style.display==='flex' ? 'none' : 'flex'; if(panel.style.display==='flex'){ input.focus(); } };
    closeB.onclick=()=>{ panel.style.display='none'; };
    send.onclick=()=>{ const t=input.value.trim(); if(t){ input.value=''; reply(t);} };
    input.addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ const t=input.value.trim(); if(t){ input.value=''; reply(t);} } });
  </script>

  <script>
    (function(){
      const svg = document.getElementById('sim-chart');
      if(!svg) return;
      const W = 800, H = 450;
      const margin = {left:60,right:16,top:20,bottom:36};
      const cw = W - margin.left - margin.right;
      const ch = H - margin.top - margin.bottom;
      const maxKW = 5;
      function pathFrom(data){
        const stepX = cw / (data.length - 1);
        return data.map((y,i)=>{
          const x = margin.left + i*stepX;
          const yv = margin.top + ch - (Math.min(y,maxKW)/maxKW)*ch;
          return (i===0?`M ${x} ${yv}`:`L ${x} ${yv}`);
        }).join(' ');
      }
      function render(data){
        const line = svg.querySelector('#sim-line');
        const area = svg.querySelector('#sim-area');
        const d = pathFrom(data);
        line.setAttribute('d', d);
        const dArea = d + ` L ${margin.left + cw} ${margin.top + ch} L ${margin.left} ${margin.top + ch} Z`;
        area.setAttribute('d', dArea);
        const yTicks = [0,1,2,3,4,5];
        const yGroup = svg.querySelector('#sim-yticks');
        yGroup.innerHTML = yTicks.map(t=>{
          const yPos = margin.top + ch - (t/maxKW)*ch;
          return `<g><line x1="${margin.left-6}" y1="${yPos}" x2="${margin.left}" y2="${yPos}" stroke="#94a3b8"/><text x="${margin.left-10}" y="${yPos+4}" text-anchor="end" font-size="12" fill="#334155">${t}</text></g>`;
        }).join('');
        const xGroup = svg.querySelector('#sim-xticks');
        const hours = [0,6,12,18,23];
        xGroup.innerHTML = hours.map(h=>{
          const x = margin.left + (h/23)*cw;
          return `<g><line x1="${x}" y1="${margin.top+ch}" x2="${x}" y2="${margin.top+ch+6}" stroke="#94a3b8"/><text x="${x}" y="${margin.top+ch+20}" text-anchor="middle" font-size="12" fill="#334155">${h}h</text></g>`;
        }).join('');
      }
      function gen(){
        const arr=[]; const peak=4.2+Math.random()*0.6;
        for(let h=0; h<24; h++){
          const base = Math.max(0, Math.sin(Math.PI*(h-6)/12));
          const noise = (Math.random()-0.5)*0.3;
          arr.push(Math.max(0, base*peak*(0.9+noise)));
        }
        return arr;
      }
      render(gen());
      const btn = document.getElementById('sim-rerun');
      if(btn){ btn.onclick = ()=> render(gen()); }
    })();
  </script>
  <!-- Modal COMPRA -->
<div id="buy-modal" class="modal-backdrop" role="dialog" aria-modal="true">
  <form id="buy-form" class="modal">
    <div class="hd">Completar compra</div>
    <div class="bd">
      <div class="form-row"><label>Paquete</label><input id="buy-plan" type="text" readonly></div>
      <div class="form-row"><label>Nombres</label><input id="buy-name" type="text" required></div>
      <div class="form-row"><label>Correo</label><input id="buy-email" type="email" required></div>
      <div class="form-row"><label>Tel√©fono</label><input id="buy-phone" type="tel" required></div>
      <div class="form-row" style="grid-template-columns:1fr">
        <label style="display:flex;gap:8px;align-items:center">
          <input id="buy-terms" type="checkbox"> Acepto los T√©rminos y Condiciones
        </label>
      </div>
      <div class="tag">Demo: se guarda en Google Sheets</div>
    </div>
    <div class="ft">
      <button type="button" id="buy-cancel" class="btn btn-ghost">Cancelar</button>
      <button type="submit" class="btn btn-primary">Enviar</button>
    </div>
  </form>
</div>

<!-- Modal LEAD/CONTACTO -->
<div id="lead-modal" class="modal-backdrop" role="dialog" aria-modal="true">
  <form id="lead-form" class="modal">
    <div class="hd">Guardar contacto</div>
    <div class="bd">
      <div class="form-row"><label>Inter√©s</label><input id="lead-plan" type="text" readonly></div>
      <div class="form-row"><label>Nombre</label><input id="lead-name" type="text" required></div>
      <div class="form-row"><label>Correo</label><input id="lead-email" type="email" required></div>
      <div class="form-row"><label>Tel√©fono</label><input id="lead-phone" type="tel" required></div>
    </div>
    <div class="ft">
      <button type="button" id="lead-cancel" class="btn btn-ghost">Cancelar</button>
      <button type="submit" class="btn btn-primary">Guardar</button>
    </div>
  </form>
</div>
<script>
  // URL del Apps Script (misma que usas en Flutter StorageService)
  const SHEETS_URL = "https://script.google.com/macros/s/AKfycbzpEHrKv5lcdKEqDgT4IMNut64NE74hSRW5ZvJTzZ1ca-pQzSVkdE7WTHdGl7cOh5CSfA/exec";

  function sendToSheets(payload){
    try{
      fetch(SHEETS_URL,{
        method:'POST',
        mode:'no-cors',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify(payload)
      });
    }catch(e){
      console.warn('Sheets error', e);
    }
  }

  // ===== Modal COMPRA =====
  function openBuyModal(plan){
    document.getElementById('buy-plan').value = plan;
    document.getElementById('buy-modal').style.display = 'flex';
  }

  document.getElementById('buy-cancel').onclick = () => {
    document.getElementById('buy-modal').style.display = 'none';
  };

  document.getElementById('buy-form').onsubmit = (e) => {
    e.preventDefault();
    if(!document.getElementById('buy-terms').checked){
      alert('Debes aceptar los T√©rminos y Condiciones.');
      return;
    }

    // Enviamos con los mismos nombres que usa tu Apps Script y Flutter
    sendToSheets({
      type:    'order',
      plan:    document.getElementById('buy-plan').value,
      nombre:  document.getElementById('buy-name').value.trim(),
      correo:  document.getElementById('buy-email').value.trim(),
      telefono:document.getElementById('buy-phone').value.trim(),
      ciudad:  '',
      factura: '',
      source:  'web:modal_buy'
    });

    alert('Gracias. Registramos tu solicitud.');
    document.getElementById('buy-modal').style.display = 'none';
  };

  // Botones ‚ÄúSolicitar cotizaci√≥n‚Äù ‚Üí abrir modal de compra
  document.querySelectorAll('#planes .card .btn-primary').forEach((btn)=>{
    const card  = btn.closest('.card');
    const title = card?.querySelector('.body:nth-child(1) div:nth-child(2)')?.textContent?.trim() || 'Plan';
    btn.addEventListener('click',(e)=>{
      e.preventDefault();
      openBuyModal(title);
    });
  });

  // ===== Modal LEAD (guardar contacto) =====
  document.getElementById('lead-cancel').onclick = () => {
    document.getElementById('lead-modal').style.display = 'none';
  };

  document.getElementById('lead-form').onsubmit = (e) => {
    e.preventDefault();

    sendToSheets({
      type:    'lead',
      plan:    document.getElementById('lead-plan').value,
      nombre:  document.getElementById('lead-name').value.trim(),
      correo:  document.getElementById('lead-email').value.trim(),
      telefono:document.getElementById('lead-phone').value.trim(),
      ciudad:  '',
      factura: '',
      source:  'web:modal_lead'
    });

    document.getElementById('lead-modal').style.display = 'none';
    alert('Contacto guardado. Te escribiremos pronto.');
  };
</script>
</body>
</html>

